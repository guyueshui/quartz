<!DOCTYPE html>
<html lang="zh" dir="ltr"><head><title>202309080931code-smells</title><meta charset="utf-8"/><link rel="preconnect" href="https://ik.imagekit.io/fonts131" crossorigin="anonymous"/><link rel="stylesheet" href="https://ik.imagekit.io/fonts131/packages/jhlst/dist/%E4%BA%AC%E8%8F%AF%E8%80%81%E5%AE%8B%E4%BD%93v1_007/result.css"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Learn2Live"/><meta property="og:title" content="202309080931code-smells"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="202309080931code-smells"/><meta name="twitter:description" content="滥用OO 被拒绝的遗赠 Refused Bequest 是什么 子类不需要父类的数据、方法 有什么问题 滥用继承，会造成理解困难，不必要的耦合 场景 子类只用父类部分方法 搞一个兄弟类，把不用的都放进去 Push Down Method Push Down Field 子类用了父类的实现，但接口不一样 可能这个时候要用代理，而不是继承 Replace Inheritance with Delegation 异曲同工的类 Alternative Classes with Different Interfaces 是什么 两个函数做一样的事，却有不同的签名 所以主要是接口不同，跟类的关系不大 有..."/><meta property="og:description" content="滥用OO 被拒绝的遗赠 Refused Bequest 是什么 子类不需要父类的数据、方法 有什么问题 滥用继承，会造成理解困难，不必要的耦合 场景 子类只用父类部分方法 搞一个兄弟类，把不用的都放进去 Push Down Method Push Down Field 子类用了父类的实现，但接口不一样 可能这个时候要用代理，而不是继承 Replace Inheritance with Delegation 异曲同工的类 Alternative Classes with Different Interfaces 是什么 两个函数做一样的事，却有不同的签名 所以主要是接口不同，跟类的关系不大 有..."/><meta property="og:image:alt" content="滥用OO 被拒绝的遗赠 Refused Bequest 是什么 子类不需要父类的数据、方法 有什么问题 滥用继承，会造成理解困难，不必要的耦合 场景 子类只用父类部分方法 搞一个兄弟类，把不用的都放进去 Push Down Method Push Down Field 子类用了父类的实现，但接口不一样 可能这个时候要用代理，而不是继承 Replace Inheritance with Delegation 异曲同工的类 Alternative Classes with Different Interfaces 是什么 两个函数做一样的事，却有不同的签名 所以主要是接口不同，跟类的关系不大 有..."/><meta property="og:image" content="https://guyueshui.github.io/quartz/static/og-image.png"/><meta property="og:image:url" content="https://guyueshui.github.io/quartz/static/og-image.png"/><meta name="twitter:image" content="https://guyueshui.github.io/quartz/static/og-image.png"/><meta property="og:image:type" content="image/.png"/><meta property="twitter:domain" content="guyueshui.github.io/quartz"/><meta property="og:url" content="https://guyueshui.github.io/quartz/__zettel/202309080931code-smells"/><meta property="twitter:url" content="https://guyueshui.github.io/quartz/__zettel/202309080931code-smells"/><meta name="description" content="滥用OO 被拒绝的遗赠 Refused Bequest 是什么 子类不需要父类的数据、方法 有什么问题 滥用继承，会造成理解困难，不必要的耦合 场景 子类只用父类部分方法 搞一个兄弟类，把不用的都放进去 Push Down Method Push Down Field 子类用了父类的实现，但接口不一样 可能这个时候要用代理，而不是继承 Replace Inheritance with Delegation 异曲同工的类 Alternative Classes with Different Interfaces 是什么 两个函数做一样的事，却有不同的签名 所以主要是接口不同，跟类的关系不大 有..."/><meta name="generator" content="Quartz"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvcnVubmVyL3dvcmsvcXVhcnR6L3F1YXJ0ei9xdWFydHovY29tcG9uZW50cy9zdHlsZXMiLCJzb3VyY2VzIjpbIm1lcm1haWQuaW5saW5lLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTtFQUNBOztBQUdGO0VBQ0U7OztBQUtGO0VBQ0U7RUFDQTs7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7O0FBSUY7RUFDRTtFQUNBO0VBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIuZXhwYW5kLWJ1dHRvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBwYWRkaW5nOiAwLjRyZW07XG4gIG1hcmdpbjogMC4zcmVtO1xuICByaWdodDogMDsgLy8gTk9URTogcmlnaHQgd2lsbCBiZSBzZXQgaW4gbWVybWFpZC5pbmxpbmUudHNcbiAgY29sb3I6IHZhcigtLWdyYXkpO1xuICBib3JkZXItY29sb3I6IHZhcigtLWRhcmspO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gIGJvcmRlcjogMXB4IHNvbGlkO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIG9wYWNpdHk6IDA7XG4gIHRyYW5zaXRpb246IDAuMnM7XG5cbiAgJiA+IHN2ZyB7XG4gICAgZmlsbDogdmFyKC0tbGlnaHQpO1xuICAgIGZpbHRlcjogY29udHJhc3QoMC4zKTtcbiAgfVxuXG4gICY6aG92ZXIge1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBib3JkZXItY29sb3I6IHZhcigtLXNlY29uZGFyeSk7XG4gIH1cblxuICAmOmZvY3VzIHtcbiAgICBvdXRsaW5lOiAwO1xuICB9XG59XG5cbnByZSB7XG4gICY6aG92ZXIgPiAuZXhwYW5kLWJ1dHRvbiB7XG4gICAgb3BhY2l0eTogMTtcbiAgICB0cmFuc2l0aW9uOiAwLjJzO1xuICB9XG59XG5cbiNtZXJtYWlkLWNvbnRhaW5lciB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgY29udGFpbjogbGF5b3V0O1xuICB6LWluZGV4OiA5OTk7XG4gIGxlZnQ6IDA7XG4gIHRvcDogMDtcbiAgd2lkdGg6IDEwMHZ3O1xuICBoZWlnaHQ6IDEwMHZoO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBkaXNwbGF5OiBub25lO1xuICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNHB4KTtcbiAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjUpO1xuXG4gICYuYWN0aXZlIHtcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIH1cblxuICAmID4gI21lcm1haWQtc3BhY2Uge1xuICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgdG9wOiA1MCU7XG4gICAgbGVmdDogNTAlO1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xuICAgIGhlaWdodDogODB2aDtcbiAgICB3aWR0aDogODB2dztcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRlbnQge1xuICAgICAgcGFkZGluZzogMnJlbTtcbiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDtcbiAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjFzIGVhc2U7XG4gICAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgICAgIG1pbi1oZWlnaHQ6IDIwMHB4O1xuICAgICAgbWluLXdpZHRoOiAyMDBweDtcblxuICAgICAgcHJlIHtcbiAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICB9XG5cbiAgICAgIHN2ZyB7XG4gICAgICAgIG1heC13aWR0aDogbm9uZTtcbiAgICAgICAgaGVpZ2h0OiBhdXRvO1xuICAgICAgfVxuICAgIH1cblxuICAgICYgPiAubWVybWFpZC1jb250cm9scyB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICBib3R0b206IDIwcHg7XG4gICAgICByaWdodDogMjBweDtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBnYXA6IDhweDtcbiAgICAgIHBhZGRpbmc6IDhweDtcbiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0KTtcbiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuICAgICAgei1pbmRleDogMjtcblxuICAgICAgLm1lcm1haWQtY29udHJvbC1idXR0b24ge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgd2lkdGg6IDMycHg7XG4gICAgICAgIGhlaWdodDogMzJweDtcbiAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgICBjb2xvcjogdmFyKC0tZGFyayk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1ib2R5Rm9udCk7XG4gICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cbiAgICAgICAgJjpob3ZlciB7XG4gICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgfVxuXG4gICAgICAgICY6YWN0aXZlIHtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0eWxlIHRoZSByZXNldCBidXR0b24gZGlmZmVyZW50bHlcbiAgICAgICAgJjpudGgtY2hpbGQoMikge1xuICAgICAgICAgIHdpZHRoOiBhdXRvO1xuICAgICAgICAgIHBhZGRpbmc6IDAgMTJweDtcbiAgICAgICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ== */</style><link href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://guyueshui.github.io/quartz/index.xml"/></head><body data-slug="__zettel/202309080931code-smells"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="..">Learn2Live</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg><p>搜索</p></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="搜索些什么" placeholder="搜索些什么"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="暗色模式"><title>暗色模式</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="亮色模式"><title>亮色模式</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="阅读模式"><title>阅读模式</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>!new Set([\&quot;assets\&quot;,\&quot;tags\&quot;,\&quot;advanced\&quot;]).has(node.displayName.toLowerCase())&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-291"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>探索</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-291" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../__zettel/">__zettel</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>202309080931code smells</a></div></nav><h1 class="article-title">202309080931code-smells</h1><p show-comma="true" class="content-meta"><time datetime="2023-09-08T01:31:32.000Z">2023年9月08日</time><span>21分钟阅读</span></p><ul class="tags"><li><a href="../tags/code-smell.html" class="internal tag-link">code-smell</a></li><li><a href="../tags/refactor.html" class="internal tag-link">refactor</a></li></ul></div></div><article class="popover-hint"><p><img src="./assets/202309080931code-smells/Pasted-image-20230908093159.png" alt loading="lazy"/></p>
<p>滥用OO
被拒绝的遗赠
Refused Bequest
是什么
子类不需要父类的数据、方法
有什么问题
滥用继承，会造成理解困难，不必要的耦合
场景
子类只用父类部分方法
搞一个兄弟类，把不用的都放进去
Push Down Method
Push Down Field
子类用了父类的实现，但接口不一样
可能这个时候要用代理，而不是继承
Replace Inheritance with Delegation
异曲同工的类
Alternative Classes with Different Interfaces
是什么
两个函数做一样的事，却有不同的签名
所以主要是接口不同，跟类的关系不大
有什么问题
缺乏抽象，引发不必要的复杂度
场景
两个函数做的事一样，签名不同
通过命名的修改来凸显问题
Rename Method
通过不停地把行为内置，让两边协议一样
Move Method
最后可能提取到父类里
Extract Superclass
临时字段
Temporary Field
是什么
为了特定情况建立的字段
有什么问题
跟其他字段生命周期不一样容易造成bug
场景
用一个或几个field当临时变量
应该创建一个新类
Extract Class
然后传参
为null设置一个field
Introduce Null Object
一个复杂算法，要用很多变量，但是作者不想传太多变量，所以把他们都搞成了field，这些变量只对这个算法有意义
提取新对象
Extract Class
新版被去掉的坏味道
不完美的类库
Incomplete Library Class
手法
Introduce Local Extension
Introduce Foreign Method
Move Method
场景
类库有些API不提供，或API不好用
switch惊悚现身
switch statements
是什么
分支判断很多，而且到处出现
不仅仅是switch关键字
有什么问题
因为四处出现，每改一个分支就要改好多地方
遗漏而出bug
即便只有一个地方，太长的分支列表也会有问题
改一个新的，不小心动到了旧代码
就算没动到新代码，也会扩散变化，无法证明整个列表中其他分支没有被改变，要做全量回归
场景
一个明显需要多态的场景
需要一连串的手法来实现一个多态替换掉它
先把整个分支列表移到一个新函数里
Extract Method
再移到你计划制造多态的新类里
Move Method
然后决定是否需要用继承体系替换掉
如果是，选择哪一种继承体系，如下：
一组State/Strategy
Replace Type Code with State/Strategy
一些子类
Replace Type Code with Subclasses
最后用继承体系替换掉
多态类的创建场景
用enum或抽象工厂或loC容器
手法同上
有时候调用端其实是只在此自己要什么的，没必要隐藏
你可以把分支里的行为抽取成具体的函数
调用段只要直接调用具体的函数就可以
Replace Parameter with Explicit Methods
有时候只是判个空
可以让调用端传入一个NullObject对象
Introduce Null Object
膨胀剂
神秘的命名
新版新加的
可以对应magic number
过长的参数列表
long parameter list
是什么
就是形参太多了
有什么问题
不容易理解
你从接口上看不出为啥需要这些数据
不容易定义出函数的职责
造成职责不单一，各种耦合
接口会经常变动
场景
几个参数明显属于一个整体
手法：组合成一个类
Introduce Parameter Object
Preserve Whole Object
参数里有对象和对象的属性
手法：那就不要传属性，直接读对象
Replace Parameter with Method
有时候自己的属性可以被对方读属性读到
就直接传自己，手法同上
Preserve Whole Object
Replace Parameter with Method
例外场景
你不需要被调对象和其他某个对象（比如自己）产生依赖（纯函数流行后，这个可能越发的多了）
这个时候，传属性是对的
过长的函数
long method
是什么
一个函数的函数体内代码行数过长
一个函数建议在20行以内
有什么问题
程序越长越难理解，自然容易出bug
场景
一个函数内有很多段逻辑，函数本身职责不单一，每段代码彼此可以通过数据传递隔离（绝大多数）
分割成小函数，并起一个合理的名字
Extract Method
如果函数内临时变量太多，或函数本身的参数太多。提取函数会制造大量的参数，搞不好就有long param list坏味道
可以用函数替代临时变量
Replace Temp with Query
这样可以在其他函数里直接调用这个新函数，省去传参
可以用对象来封装参数
Introduce Parameter Object
有时你从一个对象里去除几个数据传给函数A，这个时候，你就直接传这个对象，在函数A里面取
Preserve Whole Object
如果以上手法还不能拯救你，就可以祭出大杀器，用函数对象代替函数
Replace Method with Method Object
不要滥用
毕竟OO不是FP
不知道哪段代码，该被提取
寻找注释
哪怕只有一行代码，既然值得注释，就值得提取
发现循环
整个提取
Extract Method
新时代可以用lambda替换
发现条件表达式
把表达式提取成函数
Decompose Conditional
数据泥团
Data Dump
是什么
数据项总是扎堆出现，扎堆小时，说明他们是一个类
有什么问题
丢失的概念
往往这里有个概念，但是我们在需求传递中丢失了，造成不内聚
场景
有几个数据项，总是同时被某一个或几个函数使用
有几个数据项，总是同时被一个或几个代码块使用
手法是一样的
先把数据项抽取成对象
Introduce Parameter Object
直接传对象
Preserve Whole Object
过大的类
Large Class
是什么
单个类做了太多的事情
类的行数很长，field也很多
有什么问题
这也是百病之源
理解困难
职责不单一，代码容易耦合
场景
有些时候，这些变量适合放在子类里
那就抽取一个子类
Extract Subclass
仅仅是行数太长
也是需要提取一个新类
Extract Class
Extract Subclass
可能是职责不单一，根据客户端的使用情况不同，先提取接口，然后在动刀
Extract Interface
这个大类是GUI的类
有可能需要把业务逻辑和显示逻辑分离
哪怕你需要duplicate一套数据，两边同步
Duplicate Observed Data
如果在服务端，不要对View层的TO过于吝啬
Controller可以有自己专属的一组ViewObject
基本类型偏执
Primitive Obsession
是什么
该用结构类型来抽取概念的时候，没用，非要用基本类型
有什么问题
不内聚
逻辑泄漏的到处都是
场景
不愿意为了小任务建立小对象
比如
money
用浮点数是由风险的
contact
ZipCode
Range
URL
类型码
手法
Replace Data Value with Object
Replace Type Code with Subclass
Replace Type Code with State/Strategy
Extract Class
Introduce Parameter
数组中的不同下标代表不同含义
举例
[“张三”,18,“男”]
手法
Replace Array with Object
可有可无
夸夸其谈的未来性
Speculative Generality
是什么
过度设计的产物
认为我们未来会用到，但其实谁知道呢
有什么问题
理解困难
维护困难
看到一个精巧的设计，人们会本能的害怕，这个东西是不是有谁在用，于是一旦开放的接口只会越来越大，没有人敢删
场景
为一个简单的场景做了复杂的设计
分解成下面具体的场景，然后逐个干掉
抽象类没啥用（接口类似）
那就直接用具体类就好了
Collapse Hierarchy
不必要的委托（A通过B访问C）
那就直接依赖被委托的类（A直接访问C）
Inline Class
函数的参数没啥用
删掉没人用的参数
Remove Parameter
函数名听着太抽象
重命名
Rename Method
类和函数只有测试用例用，且这些测试用例业务上并不存在
直接删除就好了
这些没啥用，是说在当前需求中没用，
都是为了某个想象出来的需求做的设计
重复代码
Duplicated Code
是什么
在一个以上的地点看到同样的程序结构
有什么问题
重复代码是万恶之源，会衍生出其他绝大多数的坏味道
最常见的是一旦变化了，到处修改，漏改一个就是bug
场景
同一个类的两个函数含有相同的表达式
把重复的部分提取出一个函数
Extract Method
两个互为兄弟的子类中看到相同的表达式
先
Extract Method
再
Pull Up Method
前两种情况下，两部分的代码相似却不相同
首先提取相同部分
Extract Method
然后制造模板方法，把差异的部分交给子类实现
Form Template Method
有时候，代码确实不同，但其实在做同一件事，只是用了两种算法
用比较清楚的一种替代掉另一种
Substitute Algorithm
两个毫不相关的类里出现重复
先提炼到一个类里去
Extract Class
然后在另一个类里使用
注意：要决定这个函数在哪合适
可能在A
可能在B
也能在第三个类
冗余类
Lazy Class
是什么
不必要存在的类，不管是过度设计还是已经过时了
有什么问题
增加理解复杂度，已经没用的东西要尽早清理
场景
没用的类
其实方法没人用了，也改干掉
把类的代码内联回调用端
Inline Class
没用的子类
把子类和父类合成一个类，直接用
Collapse Hierarchy
莫名其妙的接口
删除接口，直接用具体实现
Collapse Hierarchy
过多的注释
Comments
是什么
因为代码很糟糕，不得不写注释
不是什么
不写注释
有什么问题
掩盖坏味道
场景
需要注释一段代码干了什么
Extract Method
需要注释一个函数干了什么
Rename Method
需要注释说明使用规格
Introduce Assertion
纯数据类
Data Class
是什么
只有数据，没有方法
有什么问题
可能是错误的抽象
场景
一堆public field
没什么好说的，封装起来
Encapsulate Field
Encapsulate Collection
只有setter和getter
把使用这些数据的函数慢慢挪到类里
Remove Setting Method
Move Method
Extract Method
Hide Method
例外
起步阶段，你可能不知道有啥未来的方法，
那就先用纯数据类，等业务出现的时候再重构
难以修改
平行的继承体系
Parallel Inheritance Hierarchies
是什么
这种情况下，假设有两个类，没给A增加一个子类，就要给B增加一个子类
有什么问题
还是因为不内聚，而容易出bug
场景
一个体系的前缀和另一个体系的前缀一模一样
先引用
再
Move Method
Move Field
虽然类一样，但不继承，还是不要过早下判断
分层架构下Domain层和View层、持久化层虽然会有类似对象，但是不继承
最主要的是，他们往往是为了处理不同的变化
比如一个是业务变化，一个是存储变化
霰弹式修改
Shotgun Surgery
是什么
一种原因改变多个类
优秀的设计是，同一种变化应该只改一个类
最多因为这个类的修改，而逻辑上合理扩散到相关的类
有什么问题
很难找到
也容易遗忘
忘一个就是一个bug
场景
来一个需求，变一处逻辑，要四处修改
把需要修改的代码放到一个类里，如果这个类不存在，就创造一个
手法
Move Method
Move Field
Inline Class
缺点
会造成发散式变化
比起霰弹式修改，还是好一点
但不是说就不管了
你可以先集中在一处，然后再慢慢重构
发散式变化
Divergent Change
是什么
多个原因改变一个类
优秀的设计是，同一个类应该只响应一种变化
不是什么
一种变化，不是一个变化
多个变化可能属于一种变化，比如业务逻辑修改，数据库替换，这是两种变化
上下文也很重要，这就要结合DDD讲了
有什么问题
违反单一职责，这种类很容易代码耦合，不容易变
也不容易理解
一个业务实体类因为缓存变一变，因为数据库变一变，因为业务逻辑变一变，最后你看这代码想看出业务逻辑到底是啥就比较费劲
场景
一个技术需求和一个业务需求都要改同一个类
不同上下文的业务，都要改同一个类
库存
产品
识别变化原因
然后Extract Class
耦合
依恋情结
Feature Envy
是什么
一个函数对另一个类的数据感兴趣的程度远超过自己所在的类
有什么问题
不够内聚
逻辑分散
场景
就是函数放错地方了，它用到的数据基本全在另一个类里，自己类里的数据反而可能只用一两个
Move Method
一段代码，用到的数据全在另一个类里
先提取函数
Extract Method
再挪到另一个类里去
Move Method
例外
visitor
strategy
这是为发散式变化付出的代价
过度耦合的消息连
Message Chains
是什么
a调b，b调c，c调d
只是为了拿个数据
有什么问题
客户端过度了解被调用端结构
被调用端改变，客户端不得不修改
场景
要通过一长串的访问拿到最终对象
识别
看看最终对象到底拿来做啥
这个方法是否属于客户端
是否可以直接把逻辑放到消息链里
或其中一个对象上
手法
Hide Delegate
Extract Method
Move Method
中间人
Middle Man
是什么
对于委托的滥用
有什么问题
莫名其妙的出现了一个委托，每次查找问题的时候会很困扰，从而难以定位bug
场景
一个类大多数的逻辑都委托给了另一个类
举例
当客户端需要指导两个概念
Person
Department
却只能通过Person拿到Department
改为
既能访问Person，也能访问Department
还能通过两者互取对方
手法
Replace Delegation with Inheritance
Inline Method
Remove Middle Man
狎昵关系
Inappropriate Intimacy
是什么
一个类对另一个类的了解太多了
不管是private的field
还是函数内在逻辑
包括私有函数
以至于自己的逻辑完全建立在对方的逻辑假设之上，从而变得两边隔空耦合
有什么问题
耦合，难以变动
场景
当两个类设计太深，变一个就得改另一个的时候
先通过搬移Method和Field看能不能隔离变化
Move Method
Move Field
如果存在双向关联，看看是不是要转为单项关联
Change Bidirectional Association to Unidirectional
看看是不是能提取出一个公共的类，双方都依赖它
Extract Class
或者这个公共的类，来替它们两个通信
Hide Delegate
子类不再适合做子类的时候
除了上述手法，有一个专题手法
Replace Inheritance with Delegation
Replace Parameter with Explicit Methods
手法是一样的
先把数据项抽取成对象
Introduce Parameter Object
直接传对象
Preserve Whole Object
这些没啥用，是说在当前需求中没用，
都是为了某个想象出来的需求做的设计
识别变化原因
然后Extract Class
这是为发散式变化付出的代价</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>关系图谱</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.2</a> © 2025 ❤️ Yychi</p><ul></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../postscript.js" type="module"></script></html>