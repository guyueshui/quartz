<!DOCTYPE html>
<html lang="zh" dir="ltr"><head><title>Linux的休眠</title><meta charset="utf-8"/><link rel="preconnect" href="https://ik.imagekit.io/fonts131" crossorigin="anonymous"/><link rel="stylesheet" href="https://ik.imagekit.io/fonts131/packages/jhlst/dist/%E4%BA%AC%E8%8F%AF%E8%80%81%E5%AE%8B%E4%BD%93v1_007/result.css"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Learn2Live"/><meta property="og:title" content="Linux的休眠"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Linux的休眠"/><meta name="twitter:description" content="先区分一下两个名词：睡眠（sleep）和休眠（hibernate）。 睡眠：将工作镜像写入内存（RAM），以便快速恢复。内存读写很快，所以睡眠的特点就是“睡得快”和“醒得快”。对于笔记本来说，合上盖子就睡了，打开盖子你的工作区间即刻就能恢复，很是方便。但是睡眠有一个缺点，就是要给内存供电，一旦断电，你的镜像数据就会丢失，工作区间将不复存在。当然这来自于内存的固有特点，建议百度RAM。 休眠：将工作镜像写入硬盘（disk，ROM），这样你也可以恢复工作区间。只是睡下去和醒过来的时间比内存慢不少。但是，它有一个好处就是断电了也不会丢失数据。当你再次开机，系统就会从硬盘里面读取镜像，恢复你的工作区间..."/><meta property="og:description" content="先区分一下两个名词：睡眠（sleep）和休眠（hibernate）。 睡眠：将工作镜像写入内存（RAM），以便快速恢复。内存读写很快，所以睡眠的特点就是“睡得快”和“醒得快”。对于笔记本来说，合上盖子就睡了，打开盖子你的工作区间即刻就能恢复，很是方便。但是睡眠有一个缺点，就是要给内存供电，一旦断电，你的镜像数据就会丢失，工作区间将不复存在。当然这来自于内存的固有特点，建议百度RAM。 休眠：将工作镜像写入硬盘（disk，ROM），这样你也可以恢复工作区间。只是睡下去和醒过来的时间比内存慢不少。但是，它有一个好处就是断电了也不会丢失数据。当你再次开机，系统就会从硬盘里面读取镜像，恢复你的工作区间..."/><meta property="og:image:alt" content="先区分一下两个名词：睡眠（sleep）和休眠（hibernate）。 睡眠：将工作镜像写入内存（RAM），以便快速恢复。内存读写很快，所以睡眠的特点就是“睡得快”和“醒得快”。对于笔记本来说，合上盖子就睡了，打开盖子你的工作区间即刻就能恢复，很是方便。但是睡眠有一个缺点，就是要给内存供电，一旦断电，你的镜像数据就会丢失，工作区间将不复存在。当然这来自于内存的固有特点，建议百度RAM。 休眠：将工作镜像写入硬盘（disk，ROM），这样你也可以恢复工作区间。只是睡下去和醒过来的时间比内存慢不少。但是，它有一个好处就是断电了也不会丢失数据。当你再次开机，系统就会从硬盘里面读取镜像，恢复你的工作区间..."/><meta property="og:image" content="https://guyueshui.github.io/quartz/static/og-image.png"/><meta property="og:image:url" content="https://guyueshui.github.io/quartz/static/og-image.png"/><meta name="twitter:image" content="https://guyueshui.github.io/quartz/static/og-image.png"/><meta property="og:image:type" content="image/.png"/><meta property="twitter:domain" content="guyueshui.github.io/quartz"/><meta property="og:url" content="https://guyueshui.github.io/quartz/Blogs/post/linux-hibernate"/><meta property="twitter:url" content="https://guyueshui.github.io/quartz/Blogs/post/linux-hibernate"/><meta name="description" content="先区分一下两个名词：睡眠（sleep）和休眠（hibernate）。 睡眠：将工作镜像写入内存（RAM），以便快速恢复。内存读写很快，所以睡眠的特点就是“睡得快”和“醒得快”。对于笔记本来说，合上盖子就睡了，打开盖子你的工作区间即刻就能恢复，很是方便。但是睡眠有一个缺点，就是要给内存供电，一旦断电，你的镜像数据就会丢失，工作区间将不复存在。当然这来自于内存的固有特点，建议百度RAM。 休眠：将工作镜像写入硬盘（disk，ROM），这样你也可以恢复工作区间。只是睡下去和醒过来的时间比内存慢不少。但是，它有一个好处就是断电了也不会丢失数据。当你再次开机，系统就会从硬盘里面读取镜像，恢复你的工作区间..."/><meta name="generator" content="Quartz"/><link href="../../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvcnVubmVyL3dvcmsvcXVhcnR6L3F1YXJ0ei9xdWFydHovY29tcG9uZW50cy9zdHlsZXMiLCJzb3VyY2VzIjpbIm1lcm1haWQuaW5saW5lLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTtFQUNBOztBQUdGO0VBQ0U7OztBQUtGO0VBQ0U7RUFDQTs7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7O0FBSUY7RUFDRTtFQUNBO0VBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIuZXhwYW5kLWJ1dHRvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBwYWRkaW5nOiAwLjRyZW07XG4gIG1hcmdpbjogMC4zcmVtO1xuICByaWdodDogMDsgLy8gTk9URTogcmlnaHQgd2lsbCBiZSBzZXQgaW4gbWVybWFpZC5pbmxpbmUudHNcbiAgY29sb3I6IHZhcigtLWdyYXkpO1xuICBib3JkZXItY29sb3I6IHZhcigtLWRhcmspO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gIGJvcmRlcjogMXB4IHNvbGlkO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIG9wYWNpdHk6IDA7XG4gIHRyYW5zaXRpb246IDAuMnM7XG5cbiAgJiA+IHN2ZyB7XG4gICAgZmlsbDogdmFyKC0tbGlnaHQpO1xuICAgIGZpbHRlcjogY29udHJhc3QoMC4zKTtcbiAgfVxuXG4gICY6aG92ZXIge1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBib3JkZXItY29sb3I6IHZhcigtLXNlY29uZGFyeSk7XG4gIH1cblxuICAmOmZvY3VzIHtcbiAgICBvdXRsaW5lOiAwO1xuICB9XG59XG5cbnByZSB7XG4gICY6aG92ZXIgPiAuZXhwYW5kLWJ1dHRvbiB7XG4gICAgb3BhY2l0eTogMTtcbiAgICB0cmFuc2l0aW9uOiAwLjJzO1xuICB9XG59XG5cbiNtZXJtYWlkLWNvbnRhaW5lciB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgY29udGFpbjogbGF5b3V0O1xuICB6LWluZGV4OiA5OTk7XG4gIGxlZnQ6IDA7XG4gIHRvcDogMDtcbiAgd2lkdGg6IDEwMHZ3O1xuICBoZWlnaHQ6IDEwMHZoO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBkaXNwbGF5OiBub25lO1xuICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNHB4KTtcbiAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjUpO1xuXG4gICYuYWN0aXZlIHtcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIH1cblxuICAmID4gI21lcm1haWQtc3BhY2Uge1xuICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgdG9wOiA1MCU7XG4gICAgbGVmdDogNTAlO1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xuICAgIGhlaWdodDogODB2aDtcbiAgICB3aWR0aDogODB2dztcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRlbnQge1xuICAgICAgcGFkZGluZzogMnJlbTtcbiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDtcbiAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjFzIGVhc2U7XG4gICAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgICAgIG1pbi1oZWlnaHQ6IDIwMHB4O1xuICAgICAgbWluLXdpZHRoOiAyMDBweDtcblxuICAgICAgcHJlIHtcbiAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICB9XG5cbiAgICAgIHN2ZyB7XG4gICAgICAgIG1heC13aWR0aDogbm9uZTtcbiAgICAgICAgaGVpZ2h0OiBhdXRvO1xuICAgICAgfVxuICAgIH1cblxuICAgICYgPiAubWVybWFpZC1jb250cm9scyB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICBib3R0b206IDIwcHg7XG4gICAgICByaWdodDogMjBweDtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBnYXA6IDhweDtcbiAgICAgIHBhZGRpbmc6IDhweDtcbiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0KTtcbiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuICAgICAgei1pbmRleDogMjtcblxuICAgICAgLm1lcm1haWQtY29udHJvbC1idXR0b24ge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgd2lkdGg6IDMycHg7XG4gICAgICAgIGhlaWdodDogMzJweDtcbiAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgICBjb2xvcjogdmFyKC0tZGFyayk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1ib2R5Rm9udCk7XG4gICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cbiAgICAgICAgJjpob3ZlciB7XG4gICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgfVxuXG4gICAgICAgICY6YWN0aXZlIHtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0eWxlIHRoZSByZXNldCBidXR0b24gZGlmZmVyZW50bHlcbiAgICAgICAgJjpudGgtY2hpbGQoMikge1xuICAgICAgICAgIHdpZHRoOiBhdXRvO1xuICAgICAgICAgIHBhZGRpbmc6IDAgMTJweDtcbiAgICAgICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ== */</style><link href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://guyueshui.github.io/quartz/index.xml"/></head><body data-slug="Blogs/post/linux-hibernate"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../..">Learn2Live</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg><p>搜索</p></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="搜索些什么" placeholder="搜索些什么"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="暗色模式"><title>暗色模式</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="亮色模式"><title>亮色模式</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="阅读模式"><title>阅读模式</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>!new Set([\&quot;assets\&quot;,\&quot;tags\&quot;,\&quot;advanced\&quot;]).has(node.displayName.toLowerCase())&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-70"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>探索</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-70" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../Blogs/">Blogs</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../Blogs/post/">post</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>linux hibernate</a></div></nav><h1 class="article-title">Linux的休眠</h1><p show-comma="true" class="content-meta"><time datetime="2020-07-13T14:44:33.000Z">2020年7月13日</time><span>20分钟阅读</span></p><ul class="tags"><li><a href="../../tags/hibernate" class="internal tag-link">hibernate</a></li></ul></div></div><article class="popover-hint"><p>先区分一下两个名词：睡眠（sleep）和休眠（hibernate）。</p>
<ul>
<li>睡眠：将工作镜像写入内存（RAM），以便快速恢复。内存读写很快，所以睡眠的特点就是“睡得快”和“醒得快”。对于笔记本来说，合上盖子就睡了，打开盖子你的工作区间即刻就能恢复，很是方便。但是睡眠有一个缺点，就是要给内存供电，一旦断电，你的镜像数据就会丢失，工作区间将不复存在。当然这来自于内存的固有特点，建议百度RAM。</li>
<li>休眠：将工作镜像写入硬盘（disk，ROM），这样你也可以恢复工作区间。只是睡下去和醒过来的时间比内存慢不少。但是，它有一个好处就是断电了也不会丢失数据。当你再次开机，系统就会从硬盘里面读取镜像，恢复你的工作区间。</li>
</ul>

<p>作为一个不求甚解的小白，我用linux这么些年，一直都只用过睡眠，每天晚上合上笔记本的盖子，第二天早上打开，工作区间即刻恢复，其实也是非常方便的，再也不用忍受关机开机的痛苦。这样一夜下来，大概要耗费7-8%的电量，还可以接受不是=。= 但是一旦你很长时间没用电脑，比如说放长假回家了，好久没碰电脑，那么笔记本的电池是会耗尽的，此时你的工作区间就丢了。（当然，这样的情况并不多见）</p>
<p>其实我以前也是鼓捣过linux休眠的，大概3-4年前，刚接触linux那会儿，在网上一通乱搜，一顿瞎试，未果。现在想来，失败的原因一是当时太菜，而是当时那个电脑太老旧了。据我所知，GPT分区下搞休眠的坑是比较多的。现在的电脑大都是EFI分区，更加简单易用。</p>
<p>总体来说，休眠还是值得折腾的，因为支持断电！而且现在普遍使用固态硬盘，休眠和恢复的速度也并不是很慢。还有一个很重要的原因，笔记本电池的寿命很短，我的本子买了3年了，现在电池容量已经缩水2/3了！</p>
<p>好了，闲话少叙，进入正题。</p>
<h2 id="确保swap分区足够大">确保swap分区足够大<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#确保swap分区足够大" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>拟使用swap分区作为写入镜像的目标分区。</p>
<p>一般建议swap分区为本机内存的一半，不过我认为有条件的还是将swap分区设置的略大于内存。此处，由于睡眠是将镜像写到内存，要确保swap分区能够容得下这个镜像，就必须将swap分区设置的大于内存。这并不是说swap小于内存就无法休眠了<sup><a href="#user-content-fn-a" id="user-content-fnref-a" data-footnote-ref aria-describedby="footnote-label" class="internal alias">1</a></sup>，具体还是要看工作区间的镜像大小了。我现在的swap就只有本机内存的一半，但还是休眠成功了。</p>
<h2 id="查看fstab">查看<code>fstab</code><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#查看fstab" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/fstab</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># &lt;file system>             &lt;mount point>  &lt;type>  &lt;options>  &lt;dump>  &lt;pass></span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /dev/nvme0n1p5</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UUID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">547054ce-bb1b-40e4-a38d-24507d31d5ca</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   /</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           ext4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        rw,relatime</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UUID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">6E76-7D08</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          /boot/efi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   vfat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,utf8,errors=remount-ro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /dev/nvme0n1p7</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UUID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">4227170f-0a4f-4a8e-a4fd-0d91f46f54af</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   none</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        swap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        defaults,pri=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre></figure>
<p>系统启动时会读取该文件，按照其中的描述挂载对应的分区。默认生成的<code>fstab</code>中，swap分区的类型是<code>swap</code>，将它改为<code>none</code>.</p>
<p>以下命令均可以查看分区信息：</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lsblk</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        MAJ:MIN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   SIZE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MOUNTPOINT</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           8:0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 223.6G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─sda1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        8:1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   110G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/yychi/EXTRA</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└─sda2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        8:2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 113.6G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nvme0n1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     259:0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 238.5G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   100M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /boot/efi</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    16M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 119.5G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   798M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    65G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    49G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└─nvme0n1p7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:7</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   4.1G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [SWAP]</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> blkid</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           fs_type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  label</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     mount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> point</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">          UUID</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">----------------------------------------------------------------------------------------------</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/nvme0n1p1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   vfat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     ESP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       /boot/efi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            6E76-7D08</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/nvme0n1p2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                      （未挂载）</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/nvme0n1p3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ntfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     OS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        （未挂载）</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      CADC772DDC7712C5</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/nvme0n1p4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ntfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               （未挂载）</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      624AD5CA4AD59B5D</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/nvme0n1p5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ext4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     ROOT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    547054ce-bb1b-40e4-a38d-24507d31d5ca</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/nvme0n1p6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ext4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     HOME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /home</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                1e23c2e3-6b73-465a-bd60-355b1bc4060b</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/nvme0n1p7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">               [SWAP]               4227170f-0a4f-4a8e-a4fd-0d91f46f54af</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/sda1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ext4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     DATA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      /home/yychi/EXTRA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    e66f87ee-33d8-4aaa-bff0-400df2276ef7</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/dev/sda2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        ntfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">               （未挂载）</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      07B60D0A64472B59</span></span></code></pre></figure>
<h2 id="添加恢复分区的内核参数">添加恢复分区的内核参数<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#添加恢复分区的内核参数" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看当前内核启动命令</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /proc/cmdline</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">\\boot\vmlinuz-linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root=/dev/nvme0n1p5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resume=/dev/nvme0n1p7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initrd=boot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nitramfs-linux.img</span></span></code></pre></figure>
<p>可以看到，内核的启动参数中<code>resume=/dev/nvme0n1p7</code>这一项就指定了从该分区恢复，而该分区正是swap分区。</p>
<p>那么如何修改内核的命令行参数呢？找到你所使用的boot manager（启动引导）程序，更改相应的配置。我使用的是<a href="https://wiki.archlinux.org/index.php/REFInd" class="external">rEFInd<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>，需要做的更改为：</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="conf" data-theme="github-light github-dark"><code data-language="conf" data-theme="github-light github-dark" style="display:grid;"><span data-line><span># file: /boot/refind_linux.conf</span></span>
<span data-line><span>&quot;Boot with standard options&quot;  &quot;ro root=/dev/nvme0n1p5 rw resume=/dev/nvme0n1p7&quot;</span></span>
<span data-line><span>&quot;Boot to single-user mode&quot;    &quot;ro root=/dev/nvme0n1p5 single&quot;</span></span></code></pre></figure>
<p>直接在第一行最后的参数列表里加上<code>rw resume=/dev/nvme0n1p7</code>即可。Ubuntu默认使用grub作为引导，这个网上教程更为详尽，此处就不再复制粘贴了。</p>
<h2 id="重新生成启动镜像">重新生成启动镜像<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#重新生成启动镜像" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>作完更改之后，使用</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mkinitcpio</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -P</span></span></code></pre></figure>
<p>重新生成启动镜像，使更改生效，最后重启系统。</p>
<p>重新进入系统之后，</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /proc/cmdline</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">\\boot\vmlinuz-linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root=/dev/nvme0n1p5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resume=/dev/nvme0n1p7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initrd=boot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nitramfs-linux.img</span></span></code></pre></figure>
<p>如果参数列表里有<code>resume=/dev/nvme0n1p7</code>则说明设置成功。你可以打开一个程序，然后</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernate</span></span></code></pre></figure>
<p>令系统休眠，然后再按下电源开关，系统会自动恢复之前的工作环境。</p>
<p>今天先这样，写的不够详细，改日再完善吧~</p>
<hr/>
<h2 id="re-hibernation">Re: hibernation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#re-hibernation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>万万没想到，今日（2022-05-04 00:14），我又为了休眠的事儿排查了两天之久。</p>
<p>自文章写完之后，一年多来，休眠一直工作的很好。直到这次五一，我准备解决一下之前一直悬而未决的<a href="../记一次重装linux#intel集成显卡滚动屏幕出现撕裂现象" class="internal alias" data-slug="Blogs/记一次重装linux">屏幕撕裂</a>问题。在此过程中，我尝试了启用笔记本的独显NVIDIA Corporation GP108M [GeForce MX150], 也为此做了很多工作，甚至从Nvidia官网下载了驱动进行安装，就是这个过程，安装报错了，然后我打算放弃，执行了卸载，卸载也报错了。最后实现的效果，确实X和picom都运行在独显上了，但是进入X之后，屏幕一片漆黑。彼时夜已深，我就打算放弃了。直接电脑休眠，而我去睡觉了。</p>
<p>第二天打开电脑，才发现大事不妙。直接变成开机了，之前的工作状态并未还原。思来想去这期间干了什么呢？尝试安装独显驱动，解决屏幕撕裂，archlinux-keyring损坏并重置，进行了系统全量更新（内核升级到5.17.5-arch1-1）, 很难排查到底是什么原因导致的。只能打开journal细细排查可能的原因，</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACPI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BIOS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bug): Could not resolve symbol [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PR.PR00._CPC], AE_NOT_FOUND (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">20211217/psargs-330</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACPI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Error:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aborting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> method</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PR.PR01._CPC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> due</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> previous</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (AE_NOT_FOUND) (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">20211217/psparse-529</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACPI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BIOS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bug): Could not resolve symbol [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PR.PR00._CPC], AE_NOT_FOUND (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">20211217/psargs-330</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACPI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Error:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aborting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> method</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PR.PR02._CPC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> due</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> previous</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (AE_NOT_FOUND) (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">20211217/psparse-529</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACPI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> BIOS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bug): Could not resolve symbol [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PR.PR00._CPC], AE_NOT_FOUND (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">20211217/psargs-330</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:01:11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACPI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Error:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aborting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> method</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">PR.PR03._CPC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> due</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> previous</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (AE_NOT_FOUND) (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">20211217/psparse-529</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span></code></pre></figure>
<p>第一个疑似的原因就是这个，但经过一番搜索，他也仅仅是个内核的bug<sup><a href="#user-content-fn-b" id="user-content-fnref-b" data-footnote-ref aria-describedby="footnote-label" class="internal alias">2</a></sup>，并不能证明他和休眠失败有直接关系。</p>
<p>接着我直接找到这段时间的系统日志，一行一行的查看，凡是有疑似的都搜索之，未果。期间我发现，之前正常休眠恢复的日志序列大概是下面这个样子：</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:59:06</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd-sleep[515989]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Entering</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sleep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'hibernate'...</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 23:59:06</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> entry</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Filesystems</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sync:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.004</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seconds</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Freezing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> space</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> processes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (elapsed </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.001</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) done.</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> OOM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> killer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disabled.</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x00000000-0x00000fff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x00058000-0x00058fff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x0009e000-0x000fffff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x71d1c000-0x71d1cfff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x71d48000-0x71d48fff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x725dc000-0x725dcfff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x725ec000-0x725ecfff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x7312f000-0x73130fff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x75388000-0x75c87fff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x7c026000-0x7c02bfff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x8be9e000-0x8cffdfff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Marking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nosave</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [mem </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0x8cfff000-0xffffffff]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Basic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> memory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bitmaps</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> created</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Preallocating</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> memory</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Allocated</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 676076</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> snapshot</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Allocated</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2704304</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kbytes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.38</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (7116.58 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Freezing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remaining</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> freezable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tasks</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (elapsed </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.001</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seconds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) done.</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 29</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:48:53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> printk:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Suspending</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> console</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) (use </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">no_console_suspend</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<p>可以看到，日志从4月28日23:59:06一下子跳到4月29日19:48:53，也就是说我在28日晚上发起了休眠，在29日晚上再度打开电脑，成功恢复了工作区。</p>
<p>而在休眠失败后日志是下面这样：</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 02:13:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd[1]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Reached</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Sleep.</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 02:13:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd[1]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Hibernate...</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 02:13:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (code </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 02:13:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dhcpcd[463]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wlp2s0:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> old</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hardware</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> f8:63:3f:4d:a1:8e</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 02:13:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dhcpcd[463]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wlp2s0:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hardware</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 66:34:25:c7:18:31</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 02:13:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd-sleep[13740]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Entering</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sleep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'hibernate'...</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 02:13:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dhcpcd[463]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wlp2s0:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> old</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hardware</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 66:34:25:c7:18:31</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 02:13:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dhcpcd[463]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wlp2s0:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hardware</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> f8:63:3f:4d:a1:8e</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 02:13:41</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PM:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> entry</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Boot</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a60e8709e7b945abbcdb13a477011e7b</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5.17.5-arch1-1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (linux@archlinux) (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gcc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (GCC) 11.2.0, GNU ld (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GNU</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Binutils</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) 2.38) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#1 SMP PREEMPT Wed, 27 Apr 2022 20:56:11 +0000</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> line:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ro</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root=/dev/nvme0n1p5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> resume=/dev/nvme0n1p7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initrd=boot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nitramfs-linux.img</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86/fpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Supporting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> XSAVE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> feature</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0x001:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'x87 floating point registers'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86/fpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Supporting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> XSAVE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> feature</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0x002:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'SSE registers'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86/fpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Supporting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> XSAVE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> feature</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0x004:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'AVX registers'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86/fpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Supporting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> XSAVE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> feature</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0x008:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'MPX bounds registers'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86/fpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Supporting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> XSAVE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> feature</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0x010:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'MPX CSR'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86/fpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xstate_offset[2]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  576,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xstate_sizes[2]:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  256</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86/fpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xstate_offset[3]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  832,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xstate_sizes[3]:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   64</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86/fpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xstate_offset[4]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  896,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xstate_sizes[4]:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   64</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">5月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 18:43:13</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MiBook-Air</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86/fpu:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Enabled</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xstate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> features</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0x1f,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> context</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> size</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 960</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> using</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'compacted'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> format.</span></span></code></pre></figure>
<p>同样在时间跳跃节点看，此前的日志看起来是休眠成功了，此后竟然直接走了boot流程！因此我猜测肯定是恢复（resume）过程出了问题，休眠（hibernation）是正常工作的。</p>
<p>我尝试过将内涵参数中的<code>resume=/dev/xxx</code>改为<code>resume=UUID=xxx-xxxx-xx</code>，也还是不行。最让人无奈的是，到现在没有发现问题所在，一直在摸黑尝试。</p>
<p>后来看到两篇文章（其实就是Ref2中提及的）:</p>
<ol>
<li><a href="https://www.kernel.org/doc/Documentation/power/basic-pm-debugging.txt" class="external">Debugging hibernation and suspend<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://01.org/blogs/rzhang/2015/best-practice-debug-linux-suspend/hibernate-issues" class="external">BEST PRACTICE TO DEBUG LINUX* SUSPEND/HIBERNATE ISSUES<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ol>
<p>开始对休眠过程进行更具针对性的debug，推荐从第一篇文章开始。经过一番debug，发现我的休眠功能确实没啥问题，恢复功能也没问题，即第一篇文章提到的：</p>
<blockquote>
<p>That test can be used to check if failures to resume from hibernation are
related to bad interactions with the platform firmware.  That is, if the above
works every time, but resume from actual hibernation does not work or is
unreliable, the platform firmware may be responsible for the failures.</p>
</blockquote>
<p>但即便知道了可能是硬件问题，我也看不出来是哪里的问题啊（太菜了orz）。无奈之下尝试第二篇的debug方法，在鼓捣了一对内核参数之后，日志确实更详尽了，但其中暴露出的问题，google都没有搜索结果。我哪看得懂啊？最后带着快要放弃的心情，再次翻开了ArchWiki（再次高呼，ArchWiki YYDS！）上的一篇文章（Ref7）, 其中提到：</p>
<blockquote>
<p>The kernel parameters will only take effect after rebooting. To be able to hibernate right away, obtain the volume’s major and minor device numbers from <a href="https://wiki.archlinux.org/title/Lsblk" title="Lsblk" class="external">lsblk<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> and echo them in format <code>*major*:*minor*</code> to <code>/sys/power/resume</code>. If using a swap file, additionally echo the resume offset to <code>/sys/power/resume_offset</code>.<a href="https://www.kernel.org/doc/html/latest/power/swsusp.html" class="external">[2]<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</blockquote>
<p>我就试探性的照做了，</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yychi@~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lsblk</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        MAJ:MIN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   SIZE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TYPE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MOUNTPOINTS</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">           8:0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 223.6G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─sda1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        8:1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   110G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/yychi/EXTRA</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└─sda2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        8:2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 113.6G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nvme0n1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     259:0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 238.5G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   100M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /boot/efi</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    16M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 119.5G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   798M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    65G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├─nvme0n1p6</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    49G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└─nvme0n1p7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:7</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   4.1G</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> part</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [SWAP]</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yychi@~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 259:7</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/power/resume</span></span></code></pre></figure>
<p>以及<a href="https://wiki.archlinux.org/title/Power_management/Suspend_and_hibernate#Configure_the_initramfs" class="external">此处<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>提及</p>
<ul>
<li>When an <a href="https://wiki.archlinux.org/title/Initramfs" title="Initramfs" class="external">initramfs<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> with the <code>base</code> hook is used, which is the default, the <code>resume</code> hook is required in <code>/etc/mkinitcpio.conf</code>. Whether by label or by UUID, the swap partition is referred to with a udev device node, so the <code>resume</code> hook must go <em>after</em> the <code>udev</code> hook. This example was made starting from the default hook configuration:</li>
</ul>
<pre><code>HOOKS=(base udev autodetect keyboard modconf block filesystems **resume** fsck)
</code></pre>
<p>Remember to <a href="https://wiki.archlinux.org/title/Regenerate_the_initramfs" title="Regenerate the initramfs" class="external">regenerate the initramfs<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> for these changes to take effect.</p>
<ul>
<li>When an initramfs with the <code>systemd</code> hook is used, a resume mechanism is already provided, and no further hooks need to be added.</li>
</ul>
<p>总结一下：就是往<code>/sys/power/resume</code>里写入正确的数值，以及在<code>/etc/mkinitcpio.conf</code>里加上<code>resume</code>hook，重新<code>mkinitcpio -P</code>，然后<strong>休眠恢复就成功</strong>了！</p>
<h3 id="小尝试">小尝试<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#小尝试" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>经过尝试，把<code>/etc/mkinitcpio.conf</code>中HOOKS中的resume去掉，再<code>mkinitcpio -P</code>，再次休眠后就无法恢复，直接走boot流程了。并且启动后<code>/sys/power/resume</code>的值丢失了（恢复默认）:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/power/resume</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0:0</span></span></code></pre></figure>
<p>而将HOOKS中的resume加上之后，再<code>mkinitcpio -P</code>生效之，重启后</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/power/resume</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">259:7</span></span></code></pre></figure>
<p>有值了，而且休眠之后可以成功恢复。</p>
<p>看起来就是这里的原因了，恢复的时候由于找不到swap分区导致fallback到boot流程，而resume hook就是起到告诉kernel swap分区的标识，因此才能成功恢复。但有一个问题，之前我没有动过这些，也能休眠并恢复成功。从<a href="https://wiki.archlinux.org/title/Power_management/Suspend_and_hibernate#Configure_the_initramfs" class="external">ArchWiki上的描述<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>来看，HOOKS中使用了<code>systemd</code>的，不需要加<code>resume</code>；使用了<code>base</code>的，需要加<code>resume</code>。看来是某些操作改了我的<code>/etc/mkinitcpio.conf</code>？</p>
<h2 id="bonus-使用sleep-hook在休眠时上锁">Bonus: 使用sleep hook在休眠时上锁<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#bonus-使用sleep-hook在休眠时上锁" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>此前使用休眠的场景是这样的：terminal里面敲<code>systemctl hibernate</code>，等待休眠成功，合上盖子，time flies, 打开盖子，启动电源，恢复工作区。这个过程没有涉及到用户验证，所以如果此间别人拿了你的电脑，自然能一窥你的裙底风光。所以，合理的做法应该是休眠时顺便锁个屏。</p>
<p>其实ArchWiki也有提到<sup><a href="#user-content-fn-c" id="user-content-fnref-c" data-footnote-ref aria-describedby="footnote-label" class="internal alias">3</a></sup><sup><a href="#user-content-fn-d" id="user-content-fnref-d" data-footnote-ref aria-describedby="footnote-label" class="internal alias">4</a></sup>，利用<code>systemd</code>管理的service可以做到。具体说来，可以创建如下文件：</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="ini" data-theme="github-light github-dark"><code data-language="ini" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /etc/systemd/system/suspend@.service</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># see: https://wiki.archlinux.org/title/Power_management#Sleep_hooks</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Unit]</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=User suspend actions</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Before</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=sleep.target</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Service]</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=%I</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=simple</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DISPLAY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=:0</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ExecStart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/usr/bin/slock</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ExecStartPost</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/usr/bin/sleep 1</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Install]</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WantedBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=sleep.target</span></span></code></pre></figure>
<p>形如<code>xxx@.service</code>的文件称为template service，它可以带一个参数拼接成一个instantiated service文件，比如<code>xxx@username.service</code>，具体可参考<code>man 5 systemd.service</code>. 上述我创建了一个<code>suspend@.service</code>，然后我们启用（enable on boot）一个instantiated service</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> suspend@yychi.service</span></span></code></pre></figure>
<p>接着reload一下使其立刻生效，</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span></code></pre></figure>
<p>然后调用<code>systemctl hibernate</code>看看效果，果然在挂起、恢复之后，出现了锁屏界面<sup><a href="#user-content-fn-e" id="user-content-fnref-e" data-footnote-ref aria-describedby="footnote-label" class="internal alias">5</a></sup>。</p>
<p>热心观众可能发现，上述service对<code>systemctl suspend</code>同样生效，其原因是suspend和hibernate同样都在<code>sleep.target</code>之后，而我们的service定义了<code>Before=sleep.target</code>，说明<code>suspend@yychi.service</code>要在<code>sleep.target</code>之前执行。因此无论是sleep还是hibernate都能用上。印证如下：</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yychi@/etc/systemd/system</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> suspend.target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                                21:15</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Unit]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Suspend</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Documentation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">man:systemd.special</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DefaultDependencies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">no</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Requires</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">systemd-suspend.service</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">After</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">systemd-suspend.service</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StopWhenUnneeded</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yes</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yychi@/etc/systemd/system</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd-suspend.service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                       21:37</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Unit]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">System</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Suspend</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Documentation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">man:systemd-suspend.service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DefaultDependencies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">no</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Requires</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">sleep.target</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">After</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">sleep.target</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 注意此处</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Service]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">oneshot</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExecStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/usr/lib/systemd/systemd-sleep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> suspend</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yychi@/etc/systemd/system</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hibernate.target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                              21:37</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Unit]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">System</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Hibernation</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Documentation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">man:systemd.special</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DefaultDependencies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">no</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Requires</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">systemd-hibernate.service</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">After</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">systemd-hibernate.service</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">StopWhenUnneeded</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">yes</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yychi@/etc/systemd/system</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">> </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd-hibernate.service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                     21:38</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /usr/lib/systemd/system/systemd-hibernate.service</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Unit]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Hibernate</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Documentation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">man:systemd-hibernate.service</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DefaultDependencies</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">no</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Requires</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">sleep.target</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">After</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">sleep.target</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 注意此处</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Service]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">oneshot</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExecStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/usr/lib/systemd/systemd-sleep</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> hibernate</span></span></code></pre></figure>
<p>关于休眠，暂时探索至此…</p>
<h2 id="references">References<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#references" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ol>
<li><a href="https://superuser.com/questions/1124966/is-hybrid-sleep-the-same-in-linux-as-in-windows" class="external">Is Hybrid Sleep the same in Linux as in Windows?<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://askubuntu.com/questions/768136/how-can-i-hibernate-on-ubuntu-16-04/821122#821122" class="external">How can I hibernate on Ubuntu 16.04?<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://askubuntu.com/questions/145443/how-do-i-use-pm-suspend-hybrid-by-default-instead-of-pm-suspend/781957#781957" class="external">How do I use pm-suspend-hybrid by default instead of pm-suspend?<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://wiki.archlinux.org/index.php/kernel_parameters#rEFInd" class="external">Kernel parameters<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://forum.manjaro.org/t/error-resume-no-device-specified-for-hibernation/119074" class="external">Error resume: no device specified for hibernation<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://bbs.archlinux.org/viewtopic.php?id=156497" class="external">Hibernation: Resume Can’t Find Swap<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://wiki.archlinux.org/title/Power_management/Suspend_and_hibernate" class="external">Power management/Suspend and hibernate - ArchWiki<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ol>
<section data-footnotes class="footnotes"><h2 class="sr-only" id="footnote-label">Footnotes<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#footnote-label" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ol>
<li id="user-content-fn-a">
<p>See <a href="https://wiki.archlinux.org/index.php/Power_management/Suspend_and_hibernate#About_swap_partition.2Ffile_size" class="external">Arch wiki<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> <a href="#user-content-fnref-a" data-footnote-backref aria-label="Back to reference 1" class="data-footnote-backref internal alias">↩</a></p>
</li>
<li id="user-content-fn-b">
<p><a href="https://github.com/intel/linux-intel-lts/issues/22" class="external">ACPI BIOS Error (bug)<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>: Could not resolve symbol [\_PR.PR00._CPC] <a href="#user-content-fnref-b" data-footnote-backref aria-label="Back to reference 2" class="data-footnote-backref internal alias">↩</a></p>
</li>
<li id="user-content-fn-c">
<p><a href="https://wiki.archlinux.org/title/Power_management#Sleep_hooks" class="external">Suspend/resume service files<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> <a href="#user-content-fnref-c" data-footnote-backref aria-label="Back to reference 3" class="data-footnote-backref internal alias">↩</a></p>
</li>
<li id="user-content-fn-d">
<p><a href="https://wiki.archlinux.org/title/Slock#Lock_on_suspend" class="external">Slock - lock on suspend<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> <a href="#user-content-fnref-d" data-footnote-backref aria-label="Back to reference 4" class="data-footnote-backref internal alias">↩</a></p>
</li>
<li id="user-content-fn-e">
<p>此处我用的是<a href="https://wiki.archlinux.org/title/Slock#Lock_on_suspend" class="external">slock<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>，X下一个非常简单轻巧的锁屏工具。简单到什么程度呢？它连配置文件都没有，想要自定义，必须改<code>config.h</code>然后重新编译！ <a href="#user-content-fnref-e" data-footnote-backref aria-label="Back to reference 5" class="data-footnote-backref internal alias">↩</a></p>
</li>
</ol>
</section></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>关系图谱</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-18" aria-expanded="true"><h3>目录</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul id="list-1" class="toc-content overflow"><li class="depth-0"><a href="#确保swap分区足够大" data-for="确保swap分区足够大">确保swap分区足够大</a></li><li class="depth-0"><a href="#查看fstab" data-for="查看fstab">查看fstab</a></li><li class="depth-0"><a href="#添加恢复分区的内核参数" data-for="添加恢复分区的内核参数">添加恢复分区的内核参数</a></li><li class="depth-0"><a href="#重新生成启动镜像" data-for="重新生成启动镜像">重新生成启动镜像</a></li><li class="depth-0"><a href="#re-hibernation" data-for="re-hibernation">Re: hibernation</a></li><li class="depth-1"><a href="#小尝试" data-for="小尝试">小尝试</a></li><li class="depth-0"><a href="#bonus-使用sleep-hook在休眠时上锁" data-for="bonus-使用sleep-hook在休眠时上锁">Bonus: 使用sleep hook在休眠时上锁</a></li><li class="depth-0"><a href="#references" data-for="references">References</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.2</a> © 2025 ❤️ Yychi</p><ul></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../../postscript.js" type="module"></script></html>